import{r as d,Q as _,S as I,E as L,a5 as E,a6 as M,B as b,j as e}from"./index-E7E3HHSK.js";import{L as Q}from"./Layout-tmITzfKy.js";import{N as Y}from"./NotAllowed-B9Dyos-N.js";const m=x=>({__html:x}),J=()=>{const[x,z]=d.useState(1),[T,K]=d.useState(10),[S,H]=d.useState(""),[k,f]=d.useState({}),{user:a}=_(s=>s.user),{data:j}=I(a==null?void 0:a.id,{skip:!(a!=null&&a.id)}),{data:l}=L({page:x,limit:T,search:S}),{data:n}=E(a==null?void 0:a.id,{skip:!(a!=null&&a.id)}),[y,{data:N,isSuccess:v,isLoading:A,error:o,reset:w}]=M(),p=l==null?void 0:l.filter(s=>s.jenis==="Kuisioner"&&s.pengisi==="Ortu"),u=l==null?void 0:l.filter(s=>s.jenis==="Angket"&&s.pengisi==="Ortu"),g=l==null?void 0:l.filter(s=>s.jenis==="Angket"&&s.pengisi==="Calon Peserta Didik"),P=(s,t)=>{f(c=>({...c,[s]:t}))},C=s=>{const t=k[s];if(!t||t.trim()===""){b.error("Jawaban tidak boleh kosong.");return}const c={userId:a==null?void 0:a.id,answer:t,quizId:s};y(c)},h=(s,t)=>{const c={userId:a==null?void 0:a.id,answer:t,quizId:s};y(c)};return d.useEffect(()=>{if(n){const s={};n.forEach(t=>{s[t.soal_id]=t.jawaban}),console.log(s),f(s)}},[n]),d.useEffect(()=>{v&&(b.success(N.message),w()),o&&(console.log(o),b.error(o.data.message),w())},[v,N,o]),console.log(n),e.jsxs(Q,{children:[e.jsxs("div",{className:"d-flex flex-column mb-3 border-bottom py-3",children:[e.jsx("h5",{className:"m-0",children:"Kuisioner & Penjadwalan"}),e.jsx("p",{className:"",children:"Pastikan kuisioner diisi sesuai dengan Pengisi "})]}),j!=null&&j.ket?e.jsxs("div",{className:"container-lg my-3",children:[e.jsx("p",{className:"h5",children:"Pengisi: Orang Tua "}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{id:"ortu",className:"table table-striped table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"No"}),e.jsx("th",{scope:"col",children:"Pertanyaan"}),e.jsx("th",{scope:"col",children:"Aksi"})]})}),e.jsx("tbody",{children:p==null?void 0:p.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",children:t+1}),e.jsx("td",{style:{textAlign:"start"},children:e.jsxs("div",{className:"d-flex flex-column gap-2",children:[e.jsx("p",{dangerouslySetInnerHTML:m(s.soal)}),e.jsx("textarea",{className:"form-control",rows:"5",placeholder:"Ketikan Jawaban di sini",value:k[s.id]||"",onChange:c=>P(s.id,c.target.value)})]})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-primary",onClick:()=>C(s.id),disabled:!!A,children:"Simpan"})})]},s.id))})]})}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{id:"ortu",className:"table table-striped table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"No"}),e.jsx("th",{scope:"col",children:"Pertanyaan"}),e.jsx("th",{scope:"col",children:"Ya"}),e.jsx("th",{scope:"col",children:"Tidak"})]})}),e.jsx("tbody",{children:u==null?void 0:u.map((s,t)=>{var c,r;return e.jsxs("tr",{children:[e.jsx("td",{scope:"row",children:t+1}),e.jsx("td",{style:{textAlign:"start"},children:e.jsx("p",{dangerouslySetInnerHTML:m(s.soal)})}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",name:"1",id:"1",className:"form-check-input",value:"Ya",checked:((c=n==null?void 0:n.find(i=>i.soal_id===s.id))==null?void 0:c.jawaban)==="Ya",onChange:i=>h(s.id,i.target.value)})}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",name:"2",id:"2",className:"form-check-input",value:"Tidak",checked:((r=n==null?void 0:n.find(i=>i.soal_id===s.id))==null?void 0:r.jawaban)==="Tidak",onChange:i=>h(s.id,i.target.value)})})]},s.id)})})]})}),e.jsx("p",{className:"h5",children:"Pengisi: Calon Siswa"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{id:"siswa",className:"table table-striped table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",style:{width:80},children:"No"}),e.jsx("th",{scope:"col",children:"Pertanyaan"}),e.jsx("th",{scope:"col",style:{width:80},children:"Ya"}),e.jsx("th",{scope:"col",style:{width:80},children:"Tidak"})]})}),e.jsx("tbody",{children:g==null?void 0:g.map((s,t)=>{var c,r;return e.jsxs("tr",{children:[e.jsx("td",{scope:"row",children:t+1}),e.jsx("td",{style:{textAlign:"start"},children:e.jsx("p",{dangerouslySetInnerHTML:m(s.soal)})}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",name:"1",id:"1",className:"form-check-input",value:"Ya",checked:((c=n==null?void 0:n.find(i=>i.soal_id===s.id))==null?void 0:c.jawaban)==="Ya",onChange:i=>h(s.id,i.target.value)})}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",name:"2",id:"2",className:"form-check-input",value:"Tidak",checked:((r=n==null?void 0:n.find(i=>i.soal_id===s.id))==null?void 0:r.jawaban)==="Tidak",onChange:i=>h(s.id,i.target.value)})})]},s.id)})})]})})]}):e.jsx(Y,{})]})};export{J as default};
