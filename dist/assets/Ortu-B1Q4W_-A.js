import{Q as v,S as w,M as L,W as $,r as p,B as g,j as t}from"./index-E7E3HHSK.js";import{L as D}from"./Layout-tmITzfKy.js";import{N as C}from"./NotAllowed-B9Dyos-N.js";const x=[{label:"NIK",type:"text"},{label:"Nama",type:"text"},{label:"Tempat Lahir",type:"text"},{label:"Tanggal Lahir",type:"date"},{label:"Pendidikan",type:"text"},{label:"Pekerjaan",type:"text"},{label:"No Tlp",type:"number"}],f=a=>a!=null&&a.startsWith("0")?`62${a.slice(1)}`:a,_=a=>{const n=new Date(a);if(isNaN(n.getTime()))return new Date;const s=n.getFullYear(),e=String(n.getMonth()+1).padStart(2,"0"),u=String(n.getDate()).padStart(2,"0");return`${s}-${e}-${u}`},T=()=>{const{user:a}=v(i=>i.user),{data:n}=w(a==null?void 0:a.id,{skip:!(a!=null&&a.id)}),{data:s}=L(a==null?void 0:a.id,{skip:!(a!=null&&a.id)}),e=s==null?void 0:s.formulir,[u,{data:c,isSuccess:h,isLoading:j,error:d,reset:m}]=$(),o=_(new Date),[r,b]=p.useState({ayah_nama:"",ayah_nik:"",ayah_tempat_lahir:"",ayah_tanggal_lahir:o,ayah_pendidikan:"",ayah_pekerjaan:"",ayah_no_tlp:"",ibu_nama:"",ibu_nik:"",ibu_tempat_lahir:"",ibu_tanggal_lahir:o,ibu_pendidikan:"",ibu_pekerjaan:"",ibu_no_tlp:""}),y=i=>{const{name:l,value:N}=i.target;b(S=>({...S,[l]:N}))},k=i=>{i.preventDefault();const l={...r,ayah_no_tlp:f(r.ayah_no_tlp),ibu_no_tlp:f(r.ibu_no_tlp)};console.log(l),u({body:l,userId:a==null?void 0:a.id})};return p.useEffect(()=>{h&&(g.success(c.message),m()),d&&(g.error(d.data.message),m())},[c,h,d]),p.useEffect(()=>{e&&b(i=>({...i,ayah_nama:e.ayah_nama||"",ayah_nik:e.ayah_nik||"",ayah_tempat_lahir:e.ayah_tempat_lahir||"",ayah_tanggal_lahir:e.ayah_tanggal_lahir?_(e.ayah_tanggal_lahir):o,ayah_pendidikan:e.ayah_pendidikan||"",ayah_pekerjaan:e.ayah_pekerjaan||"",ayah_no_tlp:e.ayah_no_tlp||"",ibu_nama:e.ibu_nama||"",ibu_nik:e.ibu_nik||"",ibu_tempat_lahir:e.ibu_tempat_lahir||"",ibu_tanggal_lahir:e.ibu_tanggal_lahir?_(e.ibu_tanggal_lahir):o,ibu_pendidikan:e.ibu_pendidikan||"",ibu_pekerjaan:e.ibu_pekerjaan||"",ibu_no_tlp:e.ibu_no_tlp||""}))},[e]),console.log(e),t.jsxs(D,{children:[t.jsx("h5",{className:"py-2 border-bottom",children:"Data Orang Tua"}),n!=null&&n.ket?t.jsxs("form",{onSubmit:k,className:"row",children:[t.jsxs("div",{className:"col-md-6 col-sm-12 d-flex flex-column gap-3 py-2",children:[t.jsx("h6",{children:"Ayah"}),x.map((i,l)=>t.jsxs("div",{className:"input-group",children:[t.jsx("span",{style:{width:130},className:"input-group-text",id:"inputGroup-sizing-default",children:i.label}),t.jsx("input",{name:`ayah_${i.label.replace(/\s+/g,"_").toLowerCase()}`,type:i.type,className:"form-control","aria-label":"Sizing example input","aria-describedby":"inputGroup-sizing-default",required:!0,value:r[`ayah_${i.label.replace(/\s+/g,"_").toLowerCase()}`||""],onChange:y})]},`ayah_${l}`))]}),t.jsxs("div",{className:"col-md-6 col-sm-12 d-flex flex-column gap-3 py-2",children:[t.jsx("h6",{children:"Ibu"}),x.map((i,l)=>t.jsxs("div",{className:"input-group",children:[t.jsx("span",{style:{width:130},className:"input-group-text",id:"inputGroup-sizing-default",children:i.label}),t.jsx("input",{name:`ibu_${i.label.replace(/\s+/g,"_").toLowerCase()}`,type:i.type,className:"form-control","aria-label":"Sizing example input","aria-describedby":"inputGroup-sizing-default",required:!0,value:r[`ibu_${i.label.replace(/\s+/g,"_").toLowerCase()}`]||"",onChange:y})]},`ibu_${l}`))]}),t.jsx("div",{className:"d-flex justify-content-end",children:t.jsx("button",{className:"btn btn-primary",children:j?t.jsx("div",{class:"spinner-border text-light",role:"status",children:t.jsx("span",{class:"visually-hidden",children:"Loading..."})}):"Simpan"})})]}):t.jsx(C,{})]})};export{T as default};
