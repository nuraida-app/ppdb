import{r as u,Q as D,S as M,M as k,X as F,Y as L,B as h,j as e}from"./index-E7E3HHSK.js";import{L as T}from"./Layout-tmITzfKy.js";import{N as w}from"./NotAllowed-B9Dyos-N.js";import{M as z}from"./ModalComponent-DB39rCZA.js";const A=i=>{const s=new Date(i);if(isNaN(s.getTime()))return"";const n=s.getFullYear(),l=String(s.getMonth()+1).padStart(2,"0"),t=String(s.getDate()).padStart(2,"0");return`${n}-${l}-${t}`},C=i=>{const s=new Date,n=new Date(i);if(isNaN(n.getTime()))return"-";let l=s.getFullYear()-n.getFullYear();const t=s.getMonth()-n.getMonth();return(t<0||t===0&&s.getDate()<n.getDate())&&l--,l},B=()=>{const[i,s]=u.useState(""),[n,l]=u.useState(""),{user:t}=D(a=>a.user),{data:r}=M(t==null?void 0:t.id,{skip:!(t!=null&&t.id)}),{data:o}=k(t==null?void 0:t.id,{skip:!(t!=null&&t.id)}),d=o==null?void 0:o.families,[x,{data:b,isSuccess:j,isLoading:G,error:y,reset:c}]=F(),[N,{data:g,isSuccess:p,isLoading:E,error:m,reset:K}]=L(),f=()=>{if(!i||!n)return h.error("Data harus diisi");x({nama:i,tgl:n})},S=a=>N(a);return u.useEffect(()=>{p&&(h.success(g.message),c()),m&&(h.error(m.data.message),c())},[g,p,m]),e.jsxs(T,{children:[e.jsx("h5",{className:"py-2 border-bottom",children:"Data Keluarga"}),r!=null&&r.ket?e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"col-12 col-lg-auto py-2 mb-lg-2 me-lg-3 d-flex align-items-center justify-content-between border-bottom",children:[e.jsx("h5",{className:"py-2 m-0",children:"Data Keluarga"}),e.jsx("button",{className:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#keluarga",children:"Tambah"})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-striped table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"No"}),e.jsx("th",{scope:"col",children:"Nama"}),e.jsx("th",{scope:"col",children:"Tanggal Lahir"}),e.jsx("th",{scope:"col",children:"Usia"}),e.jsx("th",{scope:"col",children:"Aksi"})]})}),e.jsx("tbody",{children:d==null?void 0:d.map((a,v)=>e.jsxs("tr",{children:[e.jsx("th",{scope:"row",children:v+1}),e.jsx("td",{className:"text-start",children:a.nama}),e.jsx("td",{children:A(a.tanggal_lahir)}),e.jsx("td",{children:`${C(a.tanggal_lahir)} Thn`}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-danger",onClick:()=>S(a.id),children:"hapus"})})]},a.id))})]})})]}):e.jsx(w,{}),e.jsxs(z,{id:"keluarga",isSuccess:j,title:"Tambah Anggota Keluarga",data:b,error:y,reset:c,children:[e.jsxs("div",{className:"modal-body d-flex flex-column gap-2",children:[e.jsxs("div",{className:"input-group ",children:[e.jsx("span",{style:{width:130},className:"input-group-text",id:"inputGroup-sizing-default",children:"Nama Lengkap"}),e.jsx("input",{type:"text",className:"form-control","aria-label":"Sizing example input","aria-describedby":"inputGroup-sizing-default",required:!0,value:i,onChange:a=>s(a.target.value)})]}),e.jsxs("div",{className:"input-group ",children:[e.jsx("span",{style:{width:130},className:"input-group-text",id:"inputGroup-sizing-default",children:"Tanggal Lahir"}),e.jsx("input",{type:"date",className:"form-control","aria-label":"Sizing example input","aria-describedby":"inputGroup-sizing-default",required:!0,value:n,onChange:a=>l(a.target.value)})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Tutup"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:f,children:"Simpan"})]})]})]})};export{B as default};
