import{bD as q,r as t,bH as Q,bF as V,bG as X,B as i,j as e,P as z,O as J,q as Y,$ as Z,t as ee,X as ae,ag as se,M as j}from"./index-BXyq61jM.js";import{L as te}from"./Layout-DLzo3XWz.js";import{d as ne}from"./MoreVert-D97arJl5.js";/* empty css               */import{T as re}from"./TableContainer-CS2vQYjH.js";import{T as oe}from"./Table-Nm2oIsnk.js";import{T as ce}from"./TableHead-Bmx1h48_.js";import{T as M,a as n,b as le}from"./TableRow-BKcfXV0Y.js";import{T as ie}from"./TablePagination-BPt0HHM0.js";import"./WhatsApp-CeeFueyS.js";import"./KeyboardArrowRight-D-ilXLmr.js";const de=[{label:"No",width:40},{label:"Kode Pendaftaran",width:80},{label:"Pendaftar",width:120},{label:"Asal Sekolah",width:120},{label:"Status",width:80},{label:"Aksi",width:30}],Ce=()=>{var E;const I=q(),[f,w]=t.useState(null),[h,L]=t.useState(""),[_,B]=t.useState(""),[P,H]=t.useState(""),[d,C]=t.useState(0),[o,N]=t.useState(10),p=!!f,A=(a,s,c)=>{w(a.currentTarget),L(s),B(c)},u=()=>{w(null)},[$,{data:T,isSuccess:v,error:m,reset:y}]=Q(),[F,{data:S,isSuccess:k,error:g,reset:R}]=V(),{data:b}=X(),x=b==null?void 0:b.filter(a=>a.status_pendaftaran==="Diterima"),r=x==null?void 0:x.filter(a=>a.kode_pendaftaran.toLowerCase().includes(P.toLowerCase())),G=()=>{$(h),u()},O=()=>{F(h),u()};t.useEffect(()=>{v&&(i.success(T.message),y()),m&&(i.error(m.data.message),y())},[T,v,m]),t.useEffect(()=>{k&&(i.success(S.message),R()),g&&(i.error(g.data.message),R())},[S,k,g]);const U=(a,s)=>{C(s)},W=a=>{N(parseInt(a.target.value,10)),C(0)},D=async()=>{try{const s=await(await fetch("https://ppdb-api.nibs.sch.id/formulir/download-csv",{method:"GET",headers:{"Content-Type":"application/json"}})).blob(),c=window.URL.createObjectURL(s),l=document.createElement("a");l.href=c,l.download="pendaftar_diterima.csv",document.body.appendChild(l),l.click(),l.remove()}catch(a){console.log(a),i.error("Failed to download CSV file")}},K=()=>{const a=_.replace(/\s+/g,"-");I(`/admin/pelajar/${h}/${a}`)};return e.jsxs(te,{children:[e.jsxs(z,{sx:{p:1},children:[e.jsx(J,{variant:"h6",fontWeight:"bold",children:"Pendaftar"}),e.jsxs(Y,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(Z,{type:"text",placeholder:"Kode Pendaftaran",value:P,onChange:a=>H(a.target.value),sx:{my:1}}),e.jsx(ee,{variant:"contained",color:"success",onClick:D,children:"download"})]}),e.jsx(re,{children:e.jsxs(oe,{children:[e.jsx(ce,{children:e.jsx(M,{children:de.map((a,s)=>e.jsx(n,{align:"center",sx:{minWidth:a.width},children:a.label},s))})}),e.jsx(le,{children:(E=r==null?void 0:r.slice(d*o,d*o+o))==null?void 0:E.map((a,s)=>e.jsxs(M,{children:[e.jsx(n,{align:"center",children:d*o+s+1}),e.jsx(n,{align:"center",children:a.kode_pendaftaran}),e.jsx(n,{children:a.nama}),e.jsx(n,{children:a.nama_sekolah}),e.jsx(n,{align:"center",children:e.jsx("div",{className:"diterima",children:a.status_pendaftaran})}),e.jsx(n,{align:"center",children:e.jsx(ae,{color:"primary",id:"basic-button","aria-controls":p?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":p?"true":void 0,onClick:c=>A(c,a.userid,a.nama),children:e.jsx(ne,{})})})]},s))})]})}),e.jsx(ie,{component:"div",count:(r==null?void 0:r.length)||0,page:d,onPageChange:U,rowsPerPage:o,onRowsPerPageChange:W,rowsPerPageOptions:[10,25,50],labelRowsPerPage:"Rows per page"})]}),e.jsxs(se,{id:"basic-menu",anchorEl:f,open:p,onClose:u,MenuListProps:{"aria-labelledby":"basic-button"},children:[e.jsx(j,{onClick:G,children:"Diproses"}),e.jsx(j,{onClick:O,children:"Ditolak"}),e.jsx(j,{onClick:K,children:"Detail"})]})]})};export{Ce as default};
