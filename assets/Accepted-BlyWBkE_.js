import{bF as X,r as t,bJ as z,bH as Y,bI as Z,B as i,j as e,P as ee,O as ae,q as se,$ as te,t as ne,k as I,l as L,X as re,ag as oe,M as g}from"./index-CDLjCEQ0.js";import{L as ce}from"./Layout-CZCEx_Qf.js";import{d as le}from"./MoreVert-CVde1Cv1.js";/* empty css               */import{L as E,d as M}from"./WhatsApp-COhcwcry.js";import{T as ie}from"./TableContainer-Cenbq_of.js";import{T as de}from"./Table-CYfp67TM.js";import{T as pe}from"./TableHead-bdwaIktG.js";import{T as B,a as n,b as he}from"./TableRow-CKQJj6QJ.js";import{T as ue}from"./TablePagination-Bc1O28BU.js";import"./KeyboardArrowRight-DMdDr1YV.js";const me=[{label:"No",width:40},{label:"Kode Pendaftaran",width:80},{label:"Pendaftar",width:120},{label:"Whatsapp",width:120},{label:"Status",width:80},{label:"Aksi",width:30}],ke=()=>{var R;const $=X(),[f,w]=t.useState(null),[p,A]=t.useState(""),[H,N]=t.useState(""),[C,W]=t.useState(""),[d,P]=t.useState(0),[o,F]=t.useState(10),h=!!f,O=(a,s,c)=>{w(a.currentTarget),A(s),N(c)},u=()=>{w(null)},[U,{data:y,isSuccess:T,error:m,reset:v}]=z(),[D,{data:k,isSuccess:S,error:x,reset:_}]=Y(),{data:j}=Z(),b=j==null?void 0:j.filter(a=>a.status_pendaftaran==="Diterima"),r=b==null?void 0:b.filter(a=>a.kode_pendaftaran.toLowerCase().includes(C.toLowerCase())),G=()=>{U(p),u()},K=()=>{D(p),u()};t.useEffect(()=>{T&&(i.success(y.message),v()),m&&(i.error(m.data.message),v())},[y,T,m]),t.useEffect(()=>{S&&(i.success(k.message),_()),x&&(i.error(x.data.message),_())},[k,S,x]);const q=(a,s)=>{P(s)},J=a=>{F(parseInt(a.target.value,10)),P(0)},Q=async()=>{try{const s=await(await fetch("https://ppdb-api.nibs.sch.id/formulir/download-csv",{method:"GET",headers:{"Content-Type":"application/json"}})).blob(),c=window.URL.createObjectURL(s),l=document.createElement("a");l.href=c,l.download="pendaftar_diterima.csv",document.body.appendChild(l),l.click(),l.remove()}catch(a){console.log(a),i.error("Failed to download CSV file")}},V=()=>{const a=H.replace(/\s+/g,"-");$(`/admin/pelajar/${p}/${a}`)};return e.jsxs(ce,{children:[e.jsxs(ee,{sx:{p:1},children:[e.jsx(ae,{variant:"h6",fontWeight:"bold",children:"Pendaftar Diterima"}),e.jsxs(se,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(te,{type:"text",placeholder:"Kode Pendaftaran",value:C,onChange:a=>W(a.target.value),sx:{my:1}}),e.jsx(ne,{variant:"contained",color:"success",onClick:Q,children:"download"})]}),e.jsx(ie,{children:e.jsxs(de,{children:[e.jsx(pe,{children:e.jsx(B,{children:me.map((a,s)=>e.jsx(n,{align:"center",sx:{minWidth:a.width},children:a.label},s))})}),e.jsx(he,{children:(R=r==null?void 0:r.slice(d*o,d*o+o))==null?void 0:R.map((a,s)=>e.jsxs(B,{children:[e.jsx(n,{align:"center",children:d*o+s+1}),e.jsx(n,{align:"center",children:a.kode_pendaftaran}),e.jsx(n,{children:a.nama}),e.jsxs(n,{children:[e.jsxs(E,{onClick:()=>window.open(`https://wa.me/${a.tlp_ayah}`,"_blank"),children:[e.jsx(I,{children:e.jsx(M,{color:"success"})}),e.jsx(L,{primary:"Ayah",secondary:a.tlp_ayah})]}),e.jsxs(E,{onClick:()=>window.open(`https://wa.me/${a.tlp_ibu}`,"_blank"),children:[e.jsx(I,{children:e.jsx(M,{color:"success"})}),e.jsx(L,{primary:"ibu",secondary:a.tlp_ibu})]})]}),e.jsx(n,{align:"center",children:e.jsx("div",{className:"diterima",children:a.status_pendaftaran})}),e.jsx(n,{align:"center",children:e.jsx(re,{color:"primary",id:"basic-button","aria-controls":h?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":h?"true":void 0,onClick:c=>O(c,a.userid,a.nama),children:e.jsx(le,{})})})]},s))})]})}),e.jsx(ue,{component:"div",count:(r==null?void 0:r.length)||0,page:d,onPageChange:q,rowsPerPage:o,onRowsPerPageChange:J,rowsPerPageOptions:[10,25,50],labelRowsPerPage:"Rows per page"})]}),e.jsxs(oe,{id:"basic-menu",anchorEl:f,open:h,onClose:u,MenuListProps:{"aria-labelledby":"basic-button"},children:[e.jsx(g,{onClick:G,children:"Diproses"}),e.jsx(g,{onClick:K,children:"Ditolak"}),e.jsx(g,{onClick:V,children:"Detail"})]})]})};export{ke as default};
